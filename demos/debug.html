<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1">
  <title>调试页面</title>
  <link rel="stylesheet" href="./assets/common.css">
</head>
<body>
  <button id="out">zoom out</button>
  <button id="in">zoom in</button>
<div>
  <canvas id="mountNode" style="position: relative;">
  </canvas>
</div>
<script src="./assets/jquery-3.2.1.min.js"></script>
<script src="../build/f2.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.js"></script>
<script>

// var data = [
//   { date: 0, value: 116 },
//   { date: 1, value: 129 },
//   { date: 3, value: 135 },
//   { date: 4, value: 86 },
//   { date: 5, value: 73 },
//   { date: 6, value: 85 },
//   { date: 7, value: 73 },
//   { date: 8, value: 68 },
//   { date: 9, value: 92 },
//   { date: 10, value: 130 },
//   { date: 11, value: 245 },
//   { date: 12, value: 139 },
//   { date: 13, value: 115 },
//   { date: 14, value: 111 },
//   { date: 15, value: 309 },
//   { date: 16, value: 206 },
//   { date: 17, value: 137 },
//   { date: 18, value: 128 },
//   { date: 19, value: 85 },
//   { date: 20, value: 94 },
//   { date: 21, value: 71 },
//   { date: 22, value: 106 },
//   { date: 23, value: 84 },
//   { date: 24, value: 93 },
//   { date: 25, value: 85 },
//   { date: 26, value: 73 },
//   { date: 27, value: 83 },
//   { date: 28, value: 125 },
//   { date: 29, value: 107 },
//   { date: 30, value: 82 }
// ];

var data = [
 { date: "2017-06-05", value: 116 },
 { date: "2017-06-06", value: 129 },
 { date: "2017-06-07", value: 135 },
 { date: "2017-06-08", value: 86 },
 { date: "2017-06-09", value: 73 },
 { date: "2017-06-10", value: 85 },
 { date: "2017-06-11", value: 73 },
 { date: "2017-06-12", value: 68 },
 { date: "2017-06-13", value: 92 },
 { date: "2017-06-14", value: 130 },
 { date: "2017-06-15", value: 245 },
 { date: "2017-06-16", value: 139 },
 { date: "2017-06-17", value: 115 },
 { date: "2017-06-18", value: 111 },
 { date: "2017-06-19", value: 309 },
 { date: "2017-06-20", value: 206 },
 { date: "2017-06-21", value: 137 },
 { date: "2017-06-22", value: 128 },
 { date: "2017-06-23", value: 85 },
 { date: "2017-06-24", value: 94 },
 { date: "2017-06-25", value: 71 },
 { date: "2017-06-26", value: 106 },
 { date: "2017-06-27", value: 84 },
 { date: "2017-06-28", value: 93 },
 { date: "2017-06-29", value: 85 },
 { date: "2017-06-30", value: 73 },
 { date: "2017-07-01", value: 83 },
 { date: "2017-07-02", value: 125 },
 { date: "2017-07-03", value: 107 },
 { date: "2017-07-04", value: 82 },
 { date: "2017-07-05", value: 44 },
 { date: "2017-07-06", value: 72 },
 { date: "2017-07-07", value: 106 },
 { date: "2017-07-08", value: 107 },
 { date: "2017-07-09", value: 66 },
 { date: "2017-07-10", value: 91 },
 { date: "2017-07-11", value: 92 },
 { date: "2017-07-12", value: 113 },
 { date: "2017-07-13", value: 107 },
 { date: "2017-07-14", value: 131 },
 { date: "2017-07-15", value: 111 },
 { date: "2017-07-16", value: 64 },
 { date: "2017-07-17", value: 69 },
 { date: "2017-07-18", value: 88 },
 { date: "2017-07-19", value: 77 },
 { date: "2017-07-20", value: 83 },
 { date: "2017-07-21", value: 111 },
 { date: "2017-07-22", value: 57 },
 { date: "2017-07-23", value: 55 },
 { date: "2017-07-24", value: 60 }
];


var chart = new F2.Chart({
  id: 'mountNode',
  width: window.innerWidth,
  height: window.innerWidth > window.innerHeight ? window.innerHeight - 54 : window.innerWidth * 0.707,
  pixelRatio: window.devicePixelRatio,
  padding: [ 50, 'auto', 'auto' ],
  animate: false
});
// chart.source(data);

chart.source(data, {
  date: {
    type: 'timeCat',
    tickCount: 5,
    mask: 'MM-DD',
    range: [ 0, 1 ]
  }
});
chart.animate({
  'axis-grid': false
});

chart.axis('date', {
  grid: {
    lineDash: null,
    stroke: '#e8e8e8',
    lineWidth: 1
  }
});
// chart.tooltip({
//   showTitle: true
// });
chart.tooltip(false);
chart.interval().position('date*value');

// chart.interact('zoom', {
//   mode: 'x'
// }).interact('pan', {
//   mode: 'x',
//   onEnd(e) {
//     const xScale = chart.getXScale();
//     // timeCat 类型
//     const values = xScale.values;
//     const source = chart.get('data');
//     const yValues = [];
//     source.map(obj => {
//       const xValue = obj.date;
//       if (xScale.translate(xValue) >= 0) {
//         yValues.push(obj.value);
//       }
//     });

//     // linear
//     // const { min, max } = xScale;
//     // const source = chart.get('data');
//     // const yValues = [];
//     // source.map(obj => {
//     //   const xValue = obj.date;
//     //     if (xValue >= min && xValue <= max) {
//     //       yValues.push(obj.value);
//     //     }
//     // });

// console.log(yValues);
//     if (yValues.length) {
//       const yMin = Math.min.apply(null, yValues);
//       const yMax = Math.max.apply(null, yValues);

//       chart.scale('value', {
//         min: yMin,
//         max: yMax
//       });
//       chart.repaint();
//     }
//   }
//   // rangeMin: {
//   //   x: -100,
//   //   y: -500
//   // },
//   // rangeMax: {
//   //   x: 100,
//   //   y: 500
//   // },
// });

chart.interact('zoom', {
  mode: 'x',
});
chart.interact('pan', {
  mode: 'x',
  rangeMin: {
    //  x: -50
    x: '2017-05-01'
  },
  rangeMax: {
    x: '2017-7-24'
    // x: 200
  }
});

chart.render();

// const interactions = chart._interactions;
// const zoom = interactions.zoom[0];
// const coord = chart.get('coord');
// const xScale = chart.getXScale();
// const center = {
//   x: (coord.start.x + coord.end.x) / 2, // 170
//   y: (coord.start.y + coord.end.y) / 2  // 181
// }
// // zoom in
// const zoomIn = 0.5;
// zoom._zoomScale(xScale, zoomIn, center, 'x');
// chart.repaint();


// let out = 0.1;
// let inV = -0.1;
// let scale1 = 1;
// let scale2 = 1;

// const interactions = chart._interactions;
// const zoom = interactions.zoom[0];
// const coord = chart.get('coord');
// const xScale = chart.getXScale();
// const center = {
//   x: (coord.start.x + coord.end.x) / 2, // 170
//   y: (coord.start.y + coord.end.y) / 2  // 181
// };

// $('#out').click(e => {
//   scale1 += out;
//   zoom._zoomScale(xScale, scale1, center, 'x');
//   chart.repaint();
// });

// $('#in').click(e => {
//   scale2 += inV;
//   zoom._zoomScale(xScale, scale2, center, 'x');
//   chart.repaint();
// });

</script>
</body>
</html>
